= Creating Connector Documentation
:keywords: devkit, reference documentation
:toc: macro
:toc-title: Contents
:toclevels: 3

This document describes what to include in your connector source code files to be able to generate connector documentation.

toc::[]

== Introduction

After you build your connector, document its functionality to help customers use it effectively and reduce customer support and training costs.

Connector documentation usually consists of:

* Reference documentation (created by DevKit APIdoc workflow; see <<Generating Documentation, Generating Documentation>>)
* README
* Release notes
* User guide including use cases - for examples see link:/anypoint-connector-devkit/v/3.7/packaging-your-connector-for-release#documenting-with-use-cases[Documenting with Use Cases]

Mule builds on link:http://en.wikipedia.org/wiki/Javadoc[Javadoc] to automate and simplify the creation of technical reference documentation for your connector, by adding a custom Javadoc Doclet and some DevKit-specific Java annotations.

== Prerequisites

This document assumes you are familiar with Anypoint Studio and Javadoc. It also assumes that you have already developed and tested your connectors.

== Annotations for Generating Documentation

The following sections describe the Java annotations that can be used to generate the documentation for your connector built using Anypoint DevKit.

=== Supported Javadoc Tags

The DevKit-supported Javadoc tags are described in examples in the below sections of this document.

[width="100%",cols="20a,80a"]
|===
|`@link` | Provides an in-line link pointing to the documentation for the specified package
|`@javadoc` | Can be used on the connector class, for example, `@javadoc.url`, followed by the fully qualified name of a third-party's Java package name and the Javadoc URL. See <<Annotation for Non-Java Data Types,Annotation for Non-Java Data Types>>.
|`@param` | Used below the description of a method. `@param` adds the parameter name, and its description to the reference material. The description should be listed on the line after you specify `@param ParamName`
|`@return` | Adds the description of the type that the function returns to a section in the reference material entitled "Returns"
|===

//TODO: Juani: if necessary, need some guidance on
explaining higher level of how classes, methods and parameters are documented. Example of one each.

[NOTE]
Documentation is not mandatory, however, unless you disable the Javadoc Check, errors display. To disable Javadoc Check and show errors as warnings, right-click your project, and click *Anypoint Connector* > *Disable Javadoc check*.

=== Required Connector Metadata: @Connector and @Author

Each class annotated with `@Connector` should have a class-level Javadoc comment with a high-level overview of the extensions. This may also include the `@author` annotation.

[source, java, linenums]
----
/**
 * CMIS (Content Management Interoperability Services) is a standard for improving interoperability between ECM systems.
 *
 * @author MuleSoft, Inc.
 */
@ReconnectOn(exceptions = CMISConnectorConnectionException.class)
@Connector(name = "cmis", schemaVersion = "1.1", friendlyName = "CMIS")
public class CMISConnector implements CMISFacade {
...
----

=== Documenting @Configurable Attributes

`@Configurable` annotations can be documented with a Javadoc comment that briefly explains the attribute.

[source, java, linenums]
----
/**
 * The username to access the service
 */
 @Configurable
 private String username;

/**
 * The password to access the service
 */
 @Configurable
 private String password;

/**
 * The API endpoint;
 */
 @Configurable
 private String apiEndpoint;
----

=== Documenting @Processor Methods and Parameters

Each method annotated with @Processor or @Source (for streaming APIs) should have a Javadoc comment that includes the following:

* A description of the use of the method
* A pointer to an XML code sample for the element in Mule (described below)
//TODO: confirm this is not necessary
* For each parameter of the method, a Javadoc `@param` tag, with a description of the parameter

If the method has a return type other than `void`, a Javadoc `@return` tag with a description of the return value.

[source, java, linenums]
----
/**
 * Inserts a document into a collection, setting its id if necessary.
 *
 *
 * @param collection
 *            the name of the collection where the given document should be inserted.
 * @param document
 *            a {@link Document} instance.
 * @return the id that was just inserted
 */
@Processor
public String insertDocument(final String collection, @RefOnly @Default("#[payload]") final Document document) {
    Validate.notNull(collection);
    Validate.notNull(document);
    return config.getClient().insertObject(collection, document);
}
----
=== Annotation for Non-Java Data Types
//TODO: is this title ok, or is this annotation for native Java types too?

To embed a link in your documentation to external Javadoc reference material, it is recommended to use a placeholder within your comments in the format `{@link NonJavaDataType}`. This requires that the fully qualified name of the class be specified after `@link` `{@link package.class#member label}` *or* be provided after the `@javadoc.url` tag, otherwise the link will not be created as the package for that type will not be found.

//TODO: Juan, can you provide an example where the fully qualified path is given after @link, in the format {@link package.class#member label}?

----
/**
 * Returns a CMIS object from the repository and puts it into the cache.
 * <p/>
 *
 * @param path Path of the object to retrieve
 * @return a {@link CmisObject} instance
 */
@Processor
public CmisObject getObjectByPath(@NotNull String path) {
    return facade.getObjectByPath(path);
}
----

The base URL to the reference material for an extension's data type must be created by annotating the *connector class* with the Javadoc tag `@javadoc.url`.

* Then add a space, and enter the name of the Java package, for example, `org.bson`.
* Finally, put the Java extension's URL between brackets *[ ]*. This URL *must* be a Javadoc URL. See the following example from the MongoDB connector:

[source,java,linenums]
----
/**
*
* @author Mulesoft
* @javadoc.url org.bson[https://api.mongodb.org/java/3.1/];
* @javadoc.url com.mongodb[https://api.mongodb.org/java/3.1/];
*/
public class MongoCloudConnector {
----

DevKit concatenates the base URL for the MongoDB Java API, and the paths to the particular package, and the specific class.

image:apidoc-mongo-document-attr.png[apidoc-mongo-document-attr]

Clicking *Document* above would direct you to the reference material for this class: `https://api.mongodb.org/java/3.1/org/bson/Document.html`.

=== XML Code Samples File

The examples file must be stored in the `/doc` folder and adhere to this structure:

[source, xml, linenums]
----
<!-- BEGIN_INCLUDE(myconnector:method-a) -->
// example here
<!-- END_INCLUDE(myconnector:method-a) -->
<!-- BEGIN_INCLUDE(myconnector:method-b) -->
// example here
<!-- END_INCLUDE(myconnector:method-b) -->
...
----

Here is an example from the CMIS connector's `xml.sample` file:

[source, xml, linenums]
----
<!-- BEGIN_INCLUDE(cmis:getObjectByPath) -->
        <cmis:get-object-by-path path="/mule-cloud-connector" config-ref="config" />
<!-- END_INCLUDE(cmis:getObjectByPath) -->
----

[NOTE]
The DevKit ApiDoc can take a second valid example from the `xml.sample` file that uses the same API operation as long as the example is tagged using the same "include" tag structure above.

== Generating Documentation

Documentation can be previewed by right-clicking your project in the Package Explorer, then selecting *Anypoint Connector* > *Preview Documentation*.

[IMPORTANT]
You must have *DevKit 3.8.0* and have *JDK 7 or higher* enabled to access the updated documentation features described here. Ensure the appropriate version of DevKit is referenced in the pom.xml file, and likewise for the JDK used by the system.

When you generate documentation for your connector (*Project* > *Generate Javadoc*), DevKit automatically creates both an *HTML* file and an link:http://asciidoctor.org/docs/what-is-asciidoc/#what-is-asciidoc[AsciiDoc] file that serve as a user-friendly reference for the Javadoc comments you have added within your code explaining connector methods and attributes.

//TODO: Juani/Paulo, please confirm/adjust wording above to detail the basic process of how users generate docs and whether connector build process will create docs automatically

Alternatively, you can navigate to the connector's root directory and execute the following Maven command to generate the documentation:

----
mvn clean compile -Dgenerate.apidocs
----

The generated documentation can be found in the `target/apidocs` directory in your connector folder. Open the file `connectorname-apidoc.html` to show the fully generated documentation in the browser.

[NOTE]
If you want URLs inside your Javadoc comments to be parsed as hyperlinks, you can use the Javadoc tag `@see` to create a link for you, in the form `@see com.my.package.Class#method()`.

As you build out your connector, perform a review of the generated documentation to ensure that the contents are sane and correct. If you find the generated documentation insufficient, you can always include more detail in the Javadoc comments in your code.

== See Also

After you add all required operations to your connector and develop tests, move on to link:/anypoint-connector-devkit/v/3.7/packaging-your-connector-for-release[packaging your connector for release].
